<!doctype html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="angular.min.js"></script>
</head>

<body>
    <div ng-app="usersApp" ng-controller="usersController">

        <div id="popupsContainer">
            <div ng-include="'includes/AddForm.html'"></div>
        </div>

        <div class="users-container">
            <div class="users-block">
                <div class="users-title">
                    <h2>List of users</h2>
                </div>
                <div class="users-filters">
                    <div class="filters-pages">
                        <div>
                            <button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
                            Previous
                        </button> {{currentPage+1}}/{{numberOfPages()}}
                            <button ng-disabled="currentPage >= users.info.length/pageSize - 1" ng-click="currentPage=currentPage+1">
                            Next
                        </button>
                        </div>
                    </div>
                    <div>

                        <button class="users-add-new" onclick="show('AddForm')">Add new +</button>
                    </div>
                </div>
                <div class="users-list">
                    <div class="list-user-names">
                        <div>Full Name</div>
                        <div>User Login</div>
                        <div>User Posts</div>
                        <div class="filters-order">
                            <div class="filters-order-active" onclick="showHideOrders()">By Date</div>
                            <div class="filters-order-popup" id="orderPopup">
                                <div onclick="filterByRating()">By Rating</div>
                                <div onclick="filterByDate()">By Date</div>
                            </div>
                        </div>
                        <div></div>
                    </div>
                    <div class="list-user-block" ng-repeat="user in users.info | startFrom:currentPage*pageSize | limitTo: pageSize">
                        <div>{{user.fullname}}</div>
                        <div>{{user.username}}</div>
                        <div>{{user.post}}</div>
                        <div ng-show="showDate" ng-hide="showRating" class="list-user-date">{{user.regDate}}</div>
                        <div ng-show="showRating" ng-hide="showDate" class="list-user-rating">{{user.rating}}</div>
                        <div class="list-user-buttons"><button onclick="showEditForm(this)">Go to profile</button>
                            <form class="{{user._id}}">
                                <input type="hidden" name="_method" value="DELETE" placeholder="method" required>
                                <input type="hidden" name="id" value="{{user._id}}" placeholder="id" required>
                                <button onclick="deleteUser(this)" type="submit">Delete user <span>✖</span></button>
                            </form>
                        </div>
                        <div class="user-profile-container">
                            <div class="user-profile">
                                <div class="close-editform" onclick="hideEditForm(this)">+</div>
                                <form class="user-edit" name="EditForm" id="{{user._id}}" ng-submit="submitEditForm(EditForm.$valid)"  novalidate>
                                    <input type="hidden" name="_method" value="PUT" placeholder="id" required>
                                    <input type="hidden" name="id" value="{{user._id}}" placeholder="id" required>
                                    <div><span>Username</span><input ng-class="{ 'invalid' : EditForm.username.$invalid && !EditForm.username.$pristine }" value="{{user.username}}" name="username" ng-minlength="4" ng-maxlength="16" type="text" placeholder="Enter username" ng-model="user.username">
                                    </div>
                                    <p ng-show="EditForm.username.$invalid && !EditForm.username.$pristine">You name is required.</p>
                                    <p ng-show="EditForm.username.$error.minlength">Username is too short.</p>
                                    <p ng-show="EditForm.username.$error.maxlength">Username is too long.</p>
                                    <div><span>E-mail</span><input ng-class="{ 'invalid' : EditForm.email.$invalid && !EditForm.email.$pristine }" value="{{user.email}}" name="email" ng-model="user.email" type="email" placeholder="Enter email"> </div>
                                    <p ng-show="EditForm.email.$invalid && !EditForm.email.$pristine">Enter a valid email.</p>
                                    <div><span>Post</span><input ng-class="{ 'invalid' : EditForm.post.$error.required && EditForm.post.$dirty }" value="{{user.post}}" ng-required="true" type="text" name="post" ng-model="user.post" placeholder="User post"> </div>
                                    <p ng-show="EditForm.post.$error.required && EditForm.post.$dirty">Enter a user post.</p>
                                    <div><span>Phone</span><input ng-class="{ 'invalid' : EditForm.phone.$error.required && !EditForm.phone.$error.number && EditForm.phone.$dirty }" value="{{user.phone}}"  ng-minlength="7" ng-maxlength="13" name="phone" type="number" ng-required="true" ng-model="user.phone" placeholder="Enter phone number"> </div>
                                    <p ng-show="EditForm.phone.$error.required && !EditForm.phone.$error.number && EditForm.phone.$dirty">Enter valid phone number.</p>
                                    <p ng-show="EditForm.phone.$error.minlength || EditForm.phone.$error.maxlength">Enter a correct length phone.</p>

                                    <div><span>Password</span><input ng-class="{ 'invalid' : EditForm.password.$invalid && !EditForm.password.$pristine }" value="{{user.password}}"  name="password" ng-model="user.password" ng-minlength="8" type="password" placeholder="Enter password"> </div>
                                    <p ng-show="EditForm.password.$invalid && !EditForm.password.$pristine ">Password is required.</p>
                                    <p ng-show="EditForm.password.$error.minlength">Password is too short.</p>
                                    <div><span>Full name</span><input ng-class="{ 'invalid' : EditForm.fullname.$invalid && !EditForm.fullname.$pristine}" value="{{user.fullname}}" ng-required="true" name="fullname" ng-model="user.fullname" type="text" placeholder="Full name of user"> </div>
                                    <p ng-show="EditForm.fullname.$error.required && !EditForm.fullname.$error.number && EditForm.fullname.$dirty">Enter full name.</p>
                                    <div class="user-edit-btn">
                                        <button type="submit" ng-disabled="EditForm.$invalid" onclick="updateUser(this)">Edit user <span>✓</span></button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!--
<div class="template-search" ng-app="templateApp" ng-controller="templateController">
    <div ng-include="'templates/template-pack1.html'"></div>
    <span>Enter template name:</span> <input placeholder="Template Name" type = "text" ng-model = "templateName">
    <br>
    <br>
    <ul>
        <li ng-repeat="element in template.elements | filter: templateName">
            {{element.name}}
            <button ng-click="addElement(element.id)" class="addBtn ">Add  </button>
        </li>
    </ul>
</div>

<div class="template-display" id="addedTemplates">
</div>
<button class="clear-btn" onclick="cleanTemplates()">C<br>L<br>E<br>A<br>N</button> !-->
    <script src="js/users.js"></script>
</body>

</html>